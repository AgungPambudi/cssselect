A quick test of tokenizing:

    >>> from lxml.html.css import tokenize, parse
    >>> def ptok(s):
    ...     for item in tokenize(s):
    ...         print repr(item)
    >>> ptok('E > f[a~="y\\"x"]')
    Symbol(u'E', 0)
    Token(u'>', 2)
    Symbol(u'f', 4)
    Token(u'[', 5)
    Symbol(u'a', 6)
    Token(u'~=', 7)
    String(u'y"x', 9)
    Token(u']', 15)

Then of parsing:

    >>> parse('div, td.foo, div.bar span')
    Or([Element[div], Class[Element[td].foo], CombinedSelector[Class[Element[div].bar] <followed> Element[span]]])
    >>> parse('div > p')
    CombinedSelector[Element[div] > Element[p]]
    >>> parse('td:first')
    Pseudo[Element[td]:first]
    >>> parse('a[name]')
    Attrib[Element[a][name]]
    >>> parse('a[rel="include"]')
    Attrib[Element[a][rel = String(u'include', 6)]]
    >>> parse('a[hreflang |= \'en\']')
    Attrib[Element[a][hreflang |= String(u'en', 14)]]
    >>> parse('div:nth-child(10)')
    Function[Element[div]:nth-child(10)]
    >>> parse('div:nth-of-type(10)')
    Function[Element[div]:nth-of-type(10)]
    >>> parse('label:only')
    Pseudo[Element[label]:only]
    >>> parse('a:lang(fr)')
    Function[Element[a]:lang(Element[fr])]
    >>> parse('div:contains("foo")')
    Function[Element[div]:contains(String(u'foo', 13))]
    >>> parse('div#foobar')
    Hash[Element[div]#foobar]
    >>> parse('div:not(div.foo)')
    Function[Element[div]:not(Class[Element[div].foo])]
    >>> parse('td ~ th')
    CombinedSelector[Element[td] ~ Element[th]]

Now of translation:

    >>> def xpath(css):
    ...     print parse(css).xpath()
    >>> xpath('*')
    *
    >>> xpath('E')
    e
    >>> xpath('E[foo]')
    e[@foo]
    >>> xpath('E[foo="bar"]')
    e[@foo = 'bar']
    >>> xpath('E[foo~="bar"]')
    e[contains(concat(' ', normalize-space(@foo), ' '), ' bar ')]
    >>> xpath('E[foo^="bar"]')
    e[starts-with(@foo, 'bar')]
    >>> xpath('E[foo$="bar"]')
    e[substring(@foo, string-length(@foo)-2) = 'bar']
    >>> xpath('E[foo*="bar"]')
    e[contains(@foo, 'bar')]
    >>> xpath('E[hreflang|="en"]')
    e[@hreflang = 'en' or starts-with(@hreflang, 'en-')]
    >>> #xpath('E:root')
    >>> xpath('E:nth-child(1)')
    */e[0]
    >>> xpath('E:nth-last-child(1)')
    */e[last() - 0]
    >>> xpath('E:nth-of-type(1)')
    */e[0]
    >>> xpath('E:nth-last-of-type(1)')
    */e[last() - 0]
    >>> xpath('E:first-child')
    */e[position() = 0]
    >>> xpath('E:last-child')
    */e[position() = last()]
    >>> xpath('E:first-of-type')
    */e[0]
    >>> xpath('E:last-of-type')
    e[last()]
    >>> xpath('E:only-child')
    e[count(..) = 1]
    >>> xpath('E:only-of-type')
    e[count(../node-name(.)) = 1]
    >>> xpath('E:empty')
    e[count(.) = 0 and string(.) = '']
    >>> xpath('E:contains("foo")')
    e[contains(css:lower-case(string(.)), 'foo')]
    >>> xpath('E.warning')
    e[contains(concat(' ', normalize-space(@class), ' '), ' warning ')]
    >>> xpath('E#myid')
    e[@id='myid']
    >>> xpath('E:not(:contains("foo"))')
    e[not(contains(css:lower-case(string(.)), 'foo'))]
    >>> xpath('E F')
    e/descendant::f
    >>> xpath('E > F')
    e/f
    >>> xpath('E + F')
    e/following-sibling::f[0]
    >>> xpath('E ~ F')
    e/following-sibling::f
    >>> xpath('div#container p')
    div[@id='container']/descendant::p
